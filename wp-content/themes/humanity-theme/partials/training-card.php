<?php

global $post_object;

$place = get_field('lieu', $post_object);

$city = get_field('city', $post_object);

$is_empty = empty($place) && empty($city) && ! $is_members_only;

?>

<article class="training-card <?php
if ($is_members_only) {
    echo 'bg-yellow';
}
?>">
	<a href="<?php echo esc_url($permalink); ?>" class="training-card-thumbnail">
		<?php if ($thumbnail) : ?>
			<?php echo $thumbnail; ?>
		<?php else : ?>
			<div class="training-card-thumbnail-placeholder"></div>
		<?php endif; ?>
	</a>

	<?=
    render_chip_category_block(
        [
            'label' => esc_html(str_replace('-', ' ', $lieu)),
            'link'  => esc_url($link),
            'size'  => 'large',
            'style' => $is_members_only ? 'bg-black' : 'bg-yellow',
            'icon'  => $icon ?? '',
        ]
    );
?>

	<div class="training-card-content">
		<p class="training-date">Le <?php echo esc_html($formatted_date); ?></p>
		<h3 class="training-card-title">
			<a href="<?php echo esc_url($permalink); ?>">
				<?php echo esc_html($title); ?>
			</a>
		</h3>
		<div class="training-term
				<?php
            if ($is_empty) {
                echo 'is-empty';
            }
?>
">
			<?php if ($place) : ?>
				<div class="training-card-badge">
					<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path
							d="M12.2427 11.576L8 15.8187L3.75734 11.576C2.91823 10.7369 2.34679 9.66777 2.11529 8.50389C1.88378 7.34 2.0026 6.13361 2.45673 5.03726C2.91086 3.9409 3.6799 3.00384 4.66659 2.34455C5.65328 1.68527 6.81332 1.33337 8 1.33337C9.18669 1.33337 10.3467 1.68527 11.3334 2.34455C12.3201 3.00384 13.0891 3.9409 13.5433 5.03726C13.9974 6.13361 14.1162 7.34 13.8847 8.50389C13.6532 9.66777 13.0818 10.7369 12.2427 11.576ZM8 8.66665C8.35362 8.66665 8.69276 8.52618 8.94281 8.27613C9.19286 8.02608 9.33334 7.68694 9.33334 7.33332C9.33334 6.9797 9.19286 6.64056 8.94281 6.39051C8.69276 6.14046 8.35362 5.99999 8 5.99999C7.64638 5.99999 7.30724 6.14046 7.05719 6.39051C6.80715 6.64056 6.66667 6.9797 6.66667 7.33332C6.66667 7.68694 6.80715 8.02608 7.05719 8.27613C7.30724 8.52618 7.64638 8.66665 8 8.66665Z"
							fill="#575756"/>
					</svg>
					<span class="training-card-badge-label"><?php echo esc_html($place); ?></span>
				</div>
			<?php endif; ?>

			<?php if ($city) : ?>
				<div class="training-card-badge">
					<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path
							d="M12.2427 11.576L8 15.8187L3.75734 11.576C2.91823 10.7369 2.34679 9.66777 2.11529 8.50389C1.88378 7.34 2.0026 6.13361 2.45673 5.03726C2.91086 3.9409 3.6799 3.00384 4.66659 2.34455C5.65328 1.68527 6.81332 1.33337 8 1.33337C9.18669 1.33337 10.3467 1.68527 11.3334 2.34455C12.3201 3.00384 13.0891 3.9409 13.5433 5.03726C13.9974 6.13361 14.1162 7.34 13.8847 8.50389C13.6532 9.66777 13.0818 10.7369 12.2427 11.576ZM8 8.66665C8.35362 8.66665 8.69276 8.52618 8.94281 8.27613C9.19286 8.02608 9.33334 7.68694 9.33334 7.33332C9.33334 6.9797 9.19286 6.64056 8.94281 6.39051C8.69276 6.14046 8.35362 5.99999 8 5.99999C7.64638 5.99999 7.30724 6.14046 7.05719 6.39051C6.80715 6.64056 6.66667 6.9797 6.66667 7.33332C6.66667 7.68694 6.80715 8.02608 7.05719 8.27613C7.30724 8.52618 7.64638 8.66665 8 8.66665Z"
							fill="#575756"/>
					</svg>
					<span class="training-card-badge-label"><?php echo esc_html($city); ?></span>
				</div>
			<?php endif; ?>

			<?php if ($is_members_only) : ?>
				<div class="training-card-badge">
					<svg class="training-card-badge-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
						<path d="M8.54102 12.2916C8.54114 12.0307 8.61129 11.7745 8.74413 11.5499C8.87698 11.3253 9.06765 11.1405 9.29628 11.0147C9.5249 10.8888 9.78309 10.8267 10.0439 10.8347C10.3047 10.8426 10.5587 10.9205 10.7792 11.06C10.9997 11.1995 11.1787 11.3957 11.2976 11.628C11.4165 11.8603 11.4708 12.1202 11.455 12.3807C11.4392 12.6412 11.3538 12.8926 11.2077 13.1088C11.0616 13.325 10.8601 13.4981 10.6243 13.6099V14.1666C10.6243 14.3324 10.5585 14.4913 10.4413 14.6085C10.3241 14.7258 10.1651 14.7916 9.99935 14.7916C9.83359 14.7916 9.67462 14.7258 9.55741 14.6085C9.4402 14.4913 9.37435 14.3324 9.37435 14.1666V13.6099C9.1249 13.4916 8.91416 13.3049 8.76664 13.0715C8.61912 12.8381 8.54088 12.5677 8.54102 12.2916Z" fill="#575756"/>
						<path d="M6.04102 5.83333C6.04102 4.78352 6.45805 3.7767 7.20038 3.03437C7.94272 2.29204 8.94953 1.875 9.99935 1.875C11.0492 1.875 12.056 2.29204 12.7983 3.03437C13.5406 3.7767 13.9577 4.78352 13.9577 5.83333V7.79667C14.241 7.845 14.5027 7.92167 14.7518 8.04917C15.3395 8.34871 15.8173 8.82651 16.1168 9.41417C16.306 9.785 16.3843 10.185 16.4219 10.64C16.4577 11.0825 16.4577 11.6292 16.4577 12.3067V13.5267C16.4577 14.2042 16.4577 14.7508 16.4219 15.1933C16.3843 15.6483 16.3052 16.0483 16.1168 16.4183C15.8174 17.0067 15.3392 17.4852 14.751 17.785C14.381 17.9733 13.981 18.0517 13.526 18.0892C13.0835 18.125 12.5368 18.125 11.8593 18.125H8.13935C7.46185 18.125 6.91518 18.125 6.47268 18.0892C6.01768 18.0517 5.61768 17.9725 5.24768 17.7842C4.65928 17.4847 4.18085 17.0065 3.88102 16.4183C3.69268 16.0483 3.61435 15.6483 3.57685 15.1933C3.54102 14.7508 3.54102 14.2042 3.54102 13.5267V12.3067C3.54102 11.6292 3.54102 11.0825 3.57685 10.64C3.61435 10.185 3.69352 9.785 3.88185 9.415C4.18133 8.8266 4.65947 8.34817 5.24768 8.04833C5.49783 7.92468 5.76533 7.83982 6.04102 7.79667V5.83333ZM12.7077 5.83333C12.7077 5.11504 12.4223 4.42616 11.9144 3.91825C11.4065 3.41034 10.7176 3.125 9.99935 3.125C9.28105 3.125 8.59218 3.41034 8.08427 3.91825C7.57636 4.42616 7.29102 5.11504 7.29102 5.83333V7.71167C7.54824 7.70889 7.83102 7.70778 8.13935 7.70833H11.8593C12.1682 7.70778 12.451 7.70889 12.7077 7.71167V5.83333ZM6.57435 8.99C6.19685 9.02083 5.97935 9.07917 5.81518 9.1625C5.46207 9.34232 5.175 9.62938 4.99518 9.9825C4.91185 10.1467 4.85352 10.3642 4.82268 10.7425C4.79185 11.1275 4.79102 11.6225 4.79102 12.3333V13.5C4.79102 14.21 4.79102 14.7058 4.82268 15.0917C4.85352 15.4692 4.91185 15.6867 4.99518 15.8517C5.17518 16.2042 5.46185 16.4908 5.81518 16.6708C5.97935 16.7542 6.19685 16.8125 6.57518 16.8433C6.96018 16.8742 7.45602 16.875 8.16602 16.875H11.8327C12.5435 16.875 13.0385 16.875 13.4243 16.8433C13.8019 16.8117 14.0193 16.7542 14.1843 16.6708C14.5368 16.4908 14.8235 16.2042 15.0035 15.8517C15.0868 15.6867 15.1452 15.4692 15.176 15.0908C15.2068 14.7058 15.2077 14.21 15.2077 13.5V12.3333C15.2077 11.6225 15.2077 11.1275 15.176 10.7417C15.1443 10.3642 15.0868 10.1467 15.0035 9.98167C14.8238 9.62899 14.537 9.34224 14.1843 9.1625C14.0193 9.07917 13.8018 9.02083 13.4235 8.99C13.0385 8.95917 12.5427 8.95833 11.8327 8.95833H8.16602C7.45602 8.95833 6.96018 8.95833 6.57435 8.99Z" fill="#575756"/>
					</svg>
					<span class="training-card-badge-label">Réservé aux membres</span>
				</div>
			<?php endif; ?>
		</div>
	</div>
</article>
